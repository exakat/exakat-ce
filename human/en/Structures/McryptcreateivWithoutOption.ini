name = "mcrypt_create_iv() With Default Values";
description = "Avoid using `mcrypt_create_iv() <https://www.php.net/manual/en/function.mcrypt-create-iv.php>`_ default values.

`mcrypt_create_iv() <https://www.php.net/manual/en/function.mcrypt-create-iv.php>`_ used to have ``MCRYPT_DEV_RANDOM`` as default values, and in PHP 5.6, it now uses ``MCRYPT_DEV_URANDOM``.

<?php
    $size = mcrypt_get_iv_size(MCRYPT_CAST_256, MCRYPT_MODE_CFB);
    // mcrypt_create_iv is missing the second argument
    $iv = mcrypt_create_iv($size);

// Identical to the line below
//    $iv = mcrypt_create_iv($size, MCRYPT_DEV_RANDOM);

?>

If the code doesn't have a second argument, it relies on the default value. It is recommended to set explicitly the value, so has to avoid problems while migrating.

";
clearphp = "";
phpVersion = "5.6-";
severity = "S_MINOR";
timetofix = "T_INSTANT";
exakatSince = "0.8.4";
precision="P_HIGH"
features[] = "mcrypt"
phpErrors[] = ""
modifications[] = ""
seeAlso[] ="`mcrypt_create_iv() <https://www.php.net/manual/en/function.mcrypt-create-iv.php>`_"