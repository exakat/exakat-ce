name = "Could Use Null-Safe Object Operator";
description = "When the preceding function call has the potential to return null, employing the null-safe object operator can help mitigate fatal errors.

One approach is to assess the returned value prior to utilization, ensuring it is not null, and refraining from invoking methods on a null reference. Alternatively, the null-safe operator can be employed, allowing verification of the end result. If the result is null, it indicates an error.

Another approach is to use the null-safe operator when the intermediate methods returns an object or a null. When chained, the null-safe operator will prevent Fatal Error. 
";
code = "<?php

// direct usage, with a check on the final value
$a = foo()?->b() ?? throw new exception('something went wrong when calculating $a');
   // throw as an expression is a PHP 8.0 code


// direct usage, may yield a Fatal error
foo()->b();

// indirect usage, with a check on the returned value
$a = foo();
$c = $a ? $a->b() : null;


function foo() : ?A {
    return rand(0, 1) ? new A() : null;
}

class A {
    function b() : string { return '';}
}

?>";
clearphp = "";
severity = "S_MAJOR";
; from : S_NONE, S_MINOR, S_MAJOR, S_CRITICAL
timetofix = "T_SLOW";
; from : T_INSTANT, T_QUICK, T_SLOW
exakatSince = "2.3.3";
precision = "P_MEDIUM";
; from : P_VERY_HIGH, P_HIGH, P_MEDIUM, P_LOW, P_UNKNOWN
modifications[] = "Add a check on NULL before using the returned value";
modifications[] = "Update the previous method to prevent it from returning null";
modifications[] = "Use the null-safe object operator and test the result afterward";
; Alternative to make this code go away. 
; One by possible solution

features[] = "nullsafe-object-operator";
features[] = "nullable";
; Name of a PHP feature. 
; This should match one of the available feature description in humane/en/Features

seeAlso[] = "`PHP 8.0 feature focus: nullsafe methods <https://platform.sh/blog/2020/php-80-feature-focus-type-nullsafe-methods/>`_";
seeAlso[] = "`Nullsafe methods and properties <https://www.php.net/manual/en/language.oop5.basic.php#language.oop5.basic.nullsafe>`_";
; List of links of interest

related[] = "";
; Possible other rules that might be related to this one. 
; Use "Folder/Name" format, one each
phpVersion = "8.0+";
; Versions when this feature was deprecated. Beyond is removed, and before is fine.
; This might need a range : 7.3-7.4.

phpDeprecation = "";
; Versions when this feature was deprecated. Beyond is removed, and before is fine.
; This might need a range : 7.3-7.4.
phpErrors[] = "Call to a member function b() on null";
phpErrors[] = "Attempt to read property \"b\" on null";
phpErrors[] = "Class \"null\" not found ";
; A PHP error that may be emitted by the target faulty code

keywords[] = "";
; Human readable keywords for manual glossary
